# vorbis makefile configured for use with gcc on any platform

###############################################################################
#                                                                             #
# To build a production vorbis (preferrably using gmake), just type 'make'.   #
# To build with debugging or profiling information, use 'make debug' or       #
# 'make profile' respectively.  'make clean' is a good idea between builds    #
# with different target names, or before a final build.                       #
#                                                                             #
###############################################################################


# DO NOT EDIT BELOW! ##########################################################
# (unless, of course, you know what you are doing :) ##########################

@SET_MAKE@
FLAGS=@TYPESIZES@ @CFLAGS@
OPT=@OPT@ $(FLAGS)
DEBUG=@DEBUG@ $(FLAGS)
PROFILE=@PROFILE@ $(FLAGS)
CC=@CC@
LD=@CC@
LDFLAGS=@LDFLAGS@ $(FLAGS)
AR=@AR@
RANLIB=@RANLIB@
LIBS=@LIBS@ @pthread_lib@ -lm

OFILES = 	framing.o
TARGETFILES = 	main.o $(OFILES)

all:
	$(MAKE) target CFLAGS="$(OPT)" 

debug: 
	$(MAKE) target CFLAGS="$(DEBUG)"

profile: 
	$(MAKE) target CFLAGS="$(PROFILE)"

selftest:
	$(MAKE) clean
	$(CC) $(DEBUG) $(LDFLAGS) -D_V_SELFTEST framing.c -o test_framing 
	@echo
	@./test_framing

target:	$(TARGETFILES) libvorbis.a
	$(LD) $(CFLAGS) $(TARGETFILES) $(LDFLAGS) libvorbis.a -o ogg $(LIBS)

libvorbis.a: 	$(OFILES)	
		$(AR) -r libvorbis.a $(OFILES)
		$(RANLIB) libvorbis.a

$(OFILES): 	mdct.h

.c.o:
	$(CC) $(CFLAGS) -c $<

clean:
	-rm -f *.o *.a test* *~ *.out ogg config.*






